# End-to-End Testing Report

## Introduction
To ensure our application works as expected for different user roles, the End-to-end (E2E) testing is performed to validate the full functionality of the system from user action to final output.  

The E2E test covers the following sections: 
- User Login & Authentication
- Weapon Detection Workflow
- Alert Notification System
- Real-Time WebSocket Communication
- Security & API Authorization
- Role-based Access Control

## Testing Environment

- Frontend: Next.js (Docker Container)
- Backend: Flask + Gunicorn (Docker Container)
- Reverse Proxy: Nginx (Docker Container)
- Database: PostgreSQL

## Test cases

### Normal User
| Test Case ID | Test Description                  | Precondition                                             | Test Steps                                                                                                                                                          | Expected Result                                                    | Actual Result |
|:------------:|-----------------------------------|----------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------|---------------|
|       1      | User registers successfully       | The institution code is given by the institution admin   | 1. Enter Name, Email and password, then confirm password<br>2. Enter Institution code<br>3. Click Signup button                                                     | Account is registered and the user is redirected to the login page |               |
|       2      | User logs in successfully         | The user account is registered                           | 1. Enter email address and password<br>2. Press "Log in" button                                                                                                     | User logs in successfully and redirected to the CCTV feeds page    |               |
|       3      | User can see the live camera feed | Cameras are installed and added by the institution admin | 1. Switch to the CCTV feeds page                                                                                                                                    | All CCTV feeds are displayed concurrently                          |               |
|       4      | User can zoom in the camera feed  | Cameras are installed and added by the institution admin | 1. Switch to the CCTV feeds page<br>2. Click on the "zoom in" button for the specific CCTV feed                                                                     | The camera feed is extended to the full screen                     |               |
|       5      | User receives the alert           | The websocket communication is processed                 | 1. A gun appears and triggers weapon detection.  <br>2. Send an alert to the user                                                                                   | Alert is sent from back-end to the user                            |               |
|       6      | User logs out successfully        | The user has logged in                                   | 1. Click on the drop menu on the up-right corner<br>2. Click on the "Logout" button                                                                                 | User logs out successfully                                         |               |
|       7      | User views current alerts         | The alerts are triggered                                 | 1. Navigate to current alerts page.<br>2. Click on "View Details" for a specific alert                                                                              | User checks current alerts successfully                            |               |
|       8      | User checks alert history         | There were some alerts triggered                         | 1. Navigate to alert history page.<br>2. Click on "View Details" for a specific alert                                                                               | User checks alert history successfully                             |               |
|       9      | Unauthorized API request          | User is not logged in                                    | 1. Enter the API URL of a protected resource on the browser.<br>2. Press Enter.                                                                                     | User is redirected to the login page                               |               |
|      10      | User adds a new CCTV              | The camera is already installed                          | 1. Navigate to CCTV management page.<br>2. Click on "add new CCTV".<br>3. Enter the name, location, username, password and IP address. <br>4. Click on "Add" button | User can not have access to the CCTV management page               |               |
|      11      | User adds a new user              | The new user has registered                              | 1. Navigate to user management page.<br>2. Click on "Add User".<br>3. Enter the name, email, password, and set a role. <br>4. Click on "Save Changes" button        | User can not have access to the user management page               |               |                                                                                    |                                                                    |               |
### Site Admin
| Test Case ID | Test Description                  | Precondition                                             | Test Steps                                                                                                                                                          | Expected Result                                                    | Actual Result |
|:------------:|-----------------------------------|----------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------|---------------|
|       1      | Site Admin registers successfully       | The institution code is given by the institution admin   | 1. Enter Name, Email and password, then confirm password<br>2. Enter Institution code<br>3. Click Signup button                                                     | Account is registered and the user is redirected to the login page |               |
|       2      | Site Admin logs in successfully         | The user account is registered                           | 1. Enter email address and password<br>2. Press "Log in" button                                                                                                     | User logs in successfully and redirected to the CCTV feeds page    |               |
|       3      | Site Admin can see the live camera feed | Cameras are installed and added by the institution admin | 1. Switch to the CCTV feeds page                                                                                                                                    | All CCTV feeds are displayed concurrently                          |               |
|       4      | Site Admin can zoom in the camera feed  | Cameras are installed and added by the institution admin | 1. Switch to the CCTV feeds page<br>2. Click on the "zoom in" button for the specific CCTV feed                                                                     | The camera feed is extended to the full screen                     |               |
|       5      | Site Admin receives the alert           | The websocket communication is processed                 | 1. A gun appears and triggers weapon detection.  <br>2. Send an alert to the user                                                                                   | Alert is sent from back-end to the user                            |               |
|       6      | Site Admin logs out successfully        | The user has logged in                                   | 1. Click on the drop menu on the up-right corner<br>2. Click on the "Logout" button                                                                                 | User logs out successfully                                         |               |
|       7      | Site Admin views current alerts         | The alerts are triggered                                 | 1. Navigate to current alerts page.<br>2. Click on "View Details" for a specific alert                                                                              | User checks current alerts successfully                            |               |
|       8      | Site Admin checks alert history         | There were some alerts triggered                         | 1. Navigate to alert history page.<br>2. Click on "View Details" for a specific alert                                                                               | User checks alert history successfully                             |               |
|       9      | Unauthorized API request          | User is not logged in                                    | 1. Enter the API URL of a protected resource on the browser.<br>2. Press Enter.                                                                                     | User is redirected to the login page                               |               |
|      10      | Site Admin adds a new CCTV              | The camera is already installed                          | 1. Navigate to CCTV management page.<br>2. Click on "add new CCTV".<br>3. Enter the name, location, username, password and IP address. <br>4. Click on "Add" button | The new CCTV is added successfully               |               |
|      11      | Site Admin adds a new user              | The new user has registered                              | 1. Navigate to user management page.<br>2. Click on "Add User".<br>3. Enter the name, email, password, and set a role. <br>4. Click on "Save Changes" button        | The new user is added successfully               |               |
|      12      | Site Admin removes a CCTV from another institution        |   There exists another institution using Rakshak service         |      1. Enter the API URL of another institution on the browser                                                       |     The site admin can not have access to the CCTV management page from another insitution                                                               |               |
|      13      |  Site Admin removes a user from another institution    |    There exists another institution using Rakshak service                                                      |      1. Enter the API URL of another institution on the browser                     |     The site admin can not have access to the user management page from another insitution                                                               |               |

